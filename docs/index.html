<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tempo Tapper: The Tempo Tapper library documentation</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Tempo Tapper
   &#160;<span id="projectnumber">1.0.0</span>
   </div>
   <div id="projectbrief">A simple library to implement a tempo tapper</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">The Tempo Tapper library documentation </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#Introduction">Introduction</a></li>
<li class="level1"><a href="#Motivation">Motivation</a></li>
<li class="level1"><a href="#Platforms">Supported Platforms</a><ul><li class="level2"><a href="#Porting">Porting to new platforms</a></li>
</ul>
</li>
<li class="level1"><a href="#Example">Example - Terminal based Tempo Tapper on POSIX platforms (ex. Linux)</a></li>
<li class="level1"><a href="#CPP-Wrapper">C++ Wrapper</a></li>
</ul>
</div>
<div class="textblock"><p>Welcome to the Tempo Tapper library documentation.</p>
<h1><a class="anchor" id="Introduction"></a>
Introduction</h1>
<p>The Tempo Tapper library is a super simple and straightforward library aimed to easily implement a tempo tapper where needed. Its usage can range anywhere from a software implementation of a tempo tapper, ex. within music production software, all the way to hardware implementations, such as within a digital metronome.</p>
<h1><a class="anchor" id="Motivation"></a>
Motivation</h1>
<p>The motiviation to create this library came from the necessity to easily synchronise DIY audio-visuals to the beat of a song during real time DJ performances. While beat-detection algorithms are available, they are often too complex to run reliably on cheap hardware. Numerous DJ softwares also support DMX synchronisation, however often at the expense of needing costly hardware. After numerous experiments to automate light synchronisation trough audio input, it just happend to turn out that the use of a tempo tapper has proven itself to be much more reliable than any of the previous more complex solutions. Initially, a prototype tempo tapper software would run on my computer and would emit signals in sync with the tempo via serial to an Arduino. The Arduino would then alter the lights with every received signal. Being satisfied with the reliability of this dumb and simple solution, I was quickly inspired to write a generic library that allowed me to implement the tempo tapper directly onto the Arduino. That way, lights can be synced even in situations where access to a PC is not available.</p>
<h1><a class="anchor" id="Platforms"></a>
Supported Platforms</h1>
<p>The Tempo Tapper library has been written with cross-platform compatibility in mind. The following platforms are currently supported:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Platform </th><th class="markdownTableHeadNone">Macro </th><th class="markdownTableHeadNone">Description  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">POSIX </td><td class="markdownTableBodyNone"><code>TT_TARGET_PLATFORM_POSIX</code> </td><td class="markdownTableBodyNone">POSIX, or mostly POSIX compliant, platforms (ex. Linux, MacOS)  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Arduino </td><td class="markdownTableBodyNone"><code>TT_TARGET_PLATFORM_ARDUINO</code> </td><td class="markdownTableBodyNone">Platforms that support the Arduino programming framework  </td></tr>
</table>
<p>To use the library for your target platform, ensure that the corresponding target platform macro has been defined in the compiler flags.</p>
<h2><a class="anchor" id="Porting"></a>
Porting to new platforms</h2>
<p>The Tempo Tapper library has been written in a way where all platform specific code is isolated from the libraries external interface. Code that is platform dependant is defined in source files with the following naming:</p>
<p><code>tempo_tapper_&lt;PLATFORM&gt;.cxx</code></p>
<p>Examples:</p><ul>
<li><a class="el" href="tempo__tapper__posix_8cxx.html" title="Defines platform specific functions for POSIX compliant platforms.">src/tempo_tapper_posix.cxx</a> - POSIX specific code</li>
<li><a class="el" href="tempo__tapper__arduino_8cxx.html" title="Defines platform specific functions for Arduino compatible platforms.">src/tempo_tapper_arduino.cxx</a> - Arduino specific code</li>
</ul>
<p>Porting the Tempo Tapper libary is done trough the following steps:</p>
<p>1. In the library header, <a class="el" href="tempo__tapper_8h.html" title="Provides all necessary structs and functions to implement a tempo tapper.">include/tempo_tapper.h</a>, define (and include headers if necessary) the <code>tt_time_t</code> typedef to an appropriate data type or data strict used by the target platform to store and perform arithmetics with clock time values. This data type should be able to store time in microseconds. For example, on POSIX platforms, the library uses the <a href="https://pubs.opengroup.org/onlinepubs/7908799/xsh/systime.h.html">timeval struct</a> provided by the sys/time.h header. On Arduino platforms, an <code>unsigned long</code> is used, since that is the data type used by the <a href="https://www.arduino.cc/reference/en/language/functions/time/micros/">micros()</a> function, which returns the current time in microseconds, since the program has been started. Ensure that the typedef is guarded by a <code>#ifdef TT_TARGET_PLATFORM_&lt;PLATFORM&gt;</code> directive.</p>
<p>2. Define the following platform specific time related functions for your target platform:</p>
<ul>
<li><a class="el" href="tempo__tapper_8h.html#ab2548e0a4b4ebf06eed0cde2478a99f4" title="Receives the current clock time.">current_time()</a></li>
<li><a class="el" href="tempo__tapper_8h.html#a9e82676b897bbffc439046cc597d633a" title="Adds two time values.">add_time()</a></li>
<li><a class="el" href="tempo__tapper_8h.html#a8be4acb58f6a1bdbf36b49b6e9c6a427" title="Subtracts two time values.">sub_time()</a></li>
<li><a class="el" href="tempo__tapper_8h.html#a34adb0adab019689d84b201859beae43" title="Returns a time value in microseconds.">time_to_us()</a></li>
<li><a class="el" href="tempo__tapper_8h.html#a9f1a8f086496c86c0c5593eb8267283b" title="Resets a time var to 0.">reset_time()</a></li>
</ul>
<p>These functions should be defined in a file with the following name:</p>
<p><code>tempo_tapper_&lt;PLATFORM&gt;.cxx</code></p>
<p>Where <code>&lt;PLATFORM&gt;</code> is the name of the target platform. Ensure all code within the file is guarded by a <code>#ifdef TT_TARGET_PLATFORM_&lt;PLATFORM&gt;</code> directive.</p>
<h1><a class="anchor" id="Example"></a>
Example - Terminal based Tempo Tapper on POSIX platforms (ex. Linux)</h1>
<p>In the following section we will disect the <a class="el" href="term__tt__posix_8cxx.html" title="Example of a terminal based tempo tapper on POSIX compliant systems.">term_tt_posix.cxx</a> example, which uses the tempo tapper library, along with ncruses, to implement a terminal based tempo tapper on POSIX compliant systems (ex. Linux, MacOS).</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;unistd.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdlib.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;curses.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="tempo__tapper_8h.html">tempo_tapper.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main()</div>
<div class="line">{</div>
<div class="line">        <a class="code" href="structtempo__tapper.html">tempo_tapper</a> *tt = <a class="code" href="tempo__tapper__common_8cxx.html#a651d8d5e4cfd850c4174f8afa381526a">tt_new</a>(); <span class="comment">// Create new tempo tapper instance</span></div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Check if malloc failed</span></div>
<div class="line">        <span class="keywordflow">if</span> (tt == NULL) {</div>
<div class="line">                free(tt);</div>
<div class="line">                printf(<span class="stringliteral">&quot;term_tt: Failed to create a new tempo tapper instance!\n&quot;</span>);</div>
<div class="line">                <span class="keywordflow">return</span> EXIT_FAILURE;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Initialize ncurses</span></div>
<div class="line">        initscr();</div>
<div class="line">        timeout(-1);</div>
<div class="line">        curs_set(0);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordtype">char</span> input; <span class="comment">// Keyboard input</span></div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">do</span> {</div>
<div class="line">                clear();</div>
<div class="line">                printw(<span class="stringliteral">&quot;Use the enter key to tap a tempo. Press q to quit.\n&quot;</span>);</div>
<div class="line">                refresh();</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">while</span> (1) {</div>
<div class="line">                        input = getchar();</div>
<div class="line">                        clear();</div>
<div class="line"> </div>
<div class="line">                        <span class="keywordflow">if</span> (input == <span class="charliteral">&#39;q&#39;</span> || input == <span class="charliteral">&#39;r&#39;</span>)</div>
<div class="line">                                <span class="keywordflow">break</span>;</div>
<div class="line">                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (input == <span class="charliteral">&#39;\r&#39;</span> || input == <span class="charliteral">&#39;\n&#39;</span>)</div>
<div class="line">                                <a class="code" href="tempo__tapper__common_8cxx.html#a08a70fd14b08b0b2c49d5975777b0178">tt_tap</a>(tt); <span class="comment">// Newline received, tap!</span></div>
<div class="line">                        <span class="keywordflow">else</span></div>
<div class="line">                                printw(<span class="stringliteral">&quot;Invalid input!\n&quot;</span>);</div>
<div class="line">                        </div>
<div class="line">                        <span class="comment">// Get tempo, using tt_bpm(), and tempo period using tt_preiod_us(), and print it out!</span></div>
<div class="line">                        printw(<span class="stringliteral">&quot;Tempo: %.2f BPM, Period: %.2fms\n&quot;</span>, <a class="code" href="tempo__tapper__common_8cxx.html#aa8e3549026a6efbb514b6b36dd109432">tt_bpm</a>(tt), <span class="keywordtype">float</span>(<a class="code" href="tempo__tapper__common_8cxx.html#a64b7b4c29845f07ba8678b35968f66cc">tt_period_us</a>(tt))/1000);</div>
<div class="line">                        printw(<span class="stringliteral">&quot;Press r to reset, press q to quit.\n&quot;</span>);</div>
<div class="line">                        refresh();</div>
<div class="line">                }</div>
<div class="line"> </div>
<div class="line">                <a class="code" href="tempo__tapper__common_8cxx.html#af7160cb12c6cc18e6d4322235ba25fc4">tt_reset</a>(tt); <span class="comment">// Reset tempo tapper</span></div>
<div class="line">        } <span class="keywordflow">while</span>(input != <span class="charliteral">&#39;q&#39;</span>);</div>
<div class="line"> </div>
<div class="line">        endwin();</div>
<div class="line">        free(tt);</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment --><p>Before we get to the part where the code is explained, ensure the following dependencies have been installed:</p>
<ul>
<li><a href="https://invisible-island.net/ncurses/announce.html">ncurses</a></li>
</ul>
<p>To compile, execute the following command from the projects root directory: </p><div class="fragment"><div class="line">$ gcc -D TT_TARGET_PLATFORM_POSIX -I include/ examples/posix/term_tt_posix.cxx src/tempo_tapper_common.cxx src/tempo_tapper_posix.cxx -lncurses -o examples/posix/term_tt</div>
</div><!-- fragment --><p>Notice that we defined the <code>TT_TARGET_PLATFORM_POSIX</code> macro in the compiler flags. Not doing so, would leave the compiler clueless about which target platform we are compiling the library for and would throw an error. For a list of supported platforms, along with their necessary macros, please refer to the <a class="el" href="index.html#Platforms">Supported Platforms</a> section.</p>
<p>The resulting executable will be located in examples/posix/. To execute it from the project root directory, run: </p><div class="fragment"><div class="line">$ ./examples/posix/term_tt</div>
</div><!-- fragment --><p>Now to the actual example code itself. At the top of the code we start out by including the necessary headers: </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;unistd.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdlib.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;curses.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="tempo__tapper_8h.html">tempo_tapper.h</a>&gt;</span></div>
</div><!-- fragment --><p>Most importantly, we include the Tempo Tapper library header, <a class="el" href="tempo__tapper_8h.html" title="Provides all necessary structs and functions to implement a tempo tapper.">tempo_tapper.h</a>. This header exposes all necessary strucs and functions to implement a tempo tapper.</p>
<p>Following the header inclusions we get to the main function of our program:</p>
<div class="fragment"><div class="line"><a class="code" href="structtempo__tapper.html">tempo_tapper</a> *tt = <a class="code" href="tempo__tapper__common_8cxx.html#a651d8d5e4cfd850c4174f8afa381526a">tt_new</a>(); <span class="comment">// Create new tempo tapper instance</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Check if malloc failed</span></div>
<div class="line"><span class="keywordflow">if</span> (tt == NULL) {</div>
<div class="line">        free(tt);</div>
<div class="line">        printf(<span class="stringliteral">&quot;term_tt: Failed to create a new tempo tapper instance!\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> EXIT_FAILURE;</div>
<div class="line">}</div>
</div><!-- fragment --><p>Here we first declare and allocate a tempo tapper struct instance using the <a class="el" href="tempo__tapper__common_8cxx.html#a651d8d5e4cfd850c4174f8afa381526a" title="Creates a new tempo tapper instance.">tt_new()</a> function, and test whether it has been successfully created. Should a failure arise during the memory allocation, we free the struct pointer, print an error message and terminate the programm with an <code>EXIT_FAILURE</code> code.</p>
<p>Next up, we proceed to initialize ncurses: </p><div class="fragment"><div class="line"><span class="comment">// Initialize ncurses</span></div>
<div class="line">initscr();</div>
<div class="line">timeout(-1);</div>
<div class="line">curs_set(0);</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">char</span> input; <span class="comment">// Keyboard input</span></div>
</div><!-- fragment --><p>This will allow us to directly read keyboard input without needing to provide a terminating newline, easily clear the terminal window and allow us to hide the cursor. At the end we declare a variable that will store our terminals keyboard input.</p>
<p>Following the code further down, we find two nested loops:</p>
<div class="fragment"><div class="line"><span class="keywordflow">do</span> {</div>
<div class="line">        clear();</div>
<div class="line">        printw(<span class="stringliteral">&quot;Use the enter key to tap a tempo. Press q to quit.\n&quot;</span>);</div>
<div class="line">        refresh();</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">while</span> (1) {</div>
<div class="line">                input = getchar();</div>
<div class="line">                clear();</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">if</span> (input == <span class="charliteral">&#39;q&#39;</span> || input == <span class="charliteral">&#39;r&#39;</span>)</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (input == <span class="charliteral">&#39;\r&#39;</span> || input == <span class="charliteral">&#39;\n&#39;</span>)</div>
<div class="line">                        <a class="code" href="tempo__tapper__common_8cxx.html#a08a70fd14b08b0b2c49d5975777b0178">tt_tap</a>(tt); <span class="comment">// Newline received, tap!</span></div>
<div class="line">                <span class="keywordflow">else</span></div>
<div class="line">                        printw(<span class="stringliteral">&quot;Invalid input!\n&quot;</span>);</div>
<div class="line">                </div>
<div class="line">                <span class="comment">// Get tempo, using tt_bpm(), and tempo period using tt_preiod_us(), and print it out!</span></div>
<div class="line">                printw(<span class="stringliteral">&quot;Tempo: %.2f BPM, Period: %.2fms\n&quot;</span>, <a class="code" href="tempo__tapper__common_8cxx.html#aa8e3549026a6efbb514b6b36dd109432">tt_bpm</a>(tt), <span class="keywordtype">float</span>(<a class="code" href="tempo__tapper__common_8cxx.html#a64b7b4c29845f07ba8678b35968f66cc">tt_period_us</a>(tt))/1000);</div>
<div class="line">                printw(<span class="stringliteral">&quot;Press r to reset, press q to quit.\n&quot;</span>);</div>
<div class="line">                refresh();</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <a class="code" href="tempo__tapper__common_8cxx.html#af7160cb12c6cc18e6d4322235ba25fc4">tt_reset</a>(tt); <span class="comment">// Reset tempo tapper</span></div>
<div class="line">} <span class="keywordflow">while</span>(input != <span class="charliteral">&#39;q&#39;</span>);</div>
</div><!-- fragment --><p>The outer do-while loop checks if the <code>q</code> key has been pressed. Should that be the case, the loop is exited and the program terminates. At the top of the outer do-while loop we print the initial <code>Use the enter key to tap a tempo. Press q to quit.</code> message which greets the user whenever the program is first started, or the tapper has been reset. At the bottom of the outer do-while loop we see the tempo tapper is reset trough the <a class="el" href="tempo__tapper__common_8cxx.html#af7160cb12c6cc18e6d4322235ba25fc4" title="Resets the tempo tapper.">tt_reset()</a> function, meaning if the loop still continues (<code>input</code> is not <code>q</code>) after the nested while loop has terminated, the tempo tapper is reset. This will make more sense soon, now that we get to explain the inner while loop.</p>
<div class="fragment"><div class="line"><span class="keywordflow">while</span> (1) {</div>
<div class="line">        input = getchar();</div>
<div class="line">        clear();</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (input == <span class="charliteral">&#39;q&#39;</span> || input == <span class="charliteral">&#39;r&#39;</span>)</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (input == <span class="charliteral">&#39;\r&#39;</span> || input == <span class="charliteral">&#39;\n&#39;</span>)</div>
<div class="line">                <a class="code" href="tempo__tapper__common_8cxx.html#a08a70fd14b08b0b2c49d5975777b0178">tt_tap</a>(tt); <span class="comment">// Newline received, tap!</span></div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">                printw(<span class="stringliteral">&quot;Invalid input!\n&quot;</span>);</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// Get tempo, using tt_bpm(), and tempo period using tt_preiod_us(), and print it out!</span></div>
<div class="line">        printw(<span class="stringliteral">&quot;Tempo: %.2f BPM, Period: %.2fms\n&quot;</span>, <a class="code" href="tempo__tapper__common_8cxx.html#aa8e3549026a6efbb514b6b36dd109432">tt_bpm</a>(tt), <span class="keywordtype">float</span>(<a class="code" href="tempo__tapper__common_8cxx.html#a64b7b4c29845f07ba8678b35968f66cc">tt_period_us</a>(tt))/1000);</div>
<div class="line">        printw(<span class="stringliteral">&quot;Press r to reset, press q to quit.\n&quot;</span>);</div>
<div class="line">        refresh();</div>
<div class="line">}</div>
</div><!-- fragment --><p>At the top of this loop we retrieve the users keyboard input using the <a href="https://linux.die.net/man/3/getchar">getchar()</a> function. Due to the ncruses <a href="https://linux.die.net/man/3/timeout">timeout(-1)</a> call that we have made at the very start of the main function, <a href="https://linux.die.net/man/3/getchar">getchar()</a> does not expect a newline character, but will instead immidiately return any provided keyboard input.</p>
<p>We then proceed to clear the terminal with the <a href="https://linux.die.net/man/3/clear">clear()</a> function and evaluate which key has been pressed. If the input is <code>q</code> or <code>r</code>, the current loop is abruptly exited, the input variable is then handled by the outer do-while loop which we have already discussed previously. If the input is a carriage return <code>\r</code> or a newline character <code>\n</code>, both of which are returned by pressing the enter key, we register it as a tap and call the <a class="el" href="tempo__tapper__common_8cxx.html#a08a70fd14b08b0b2c49d5975777b0178" title="&quot;Taps&quot; the tempo tapper">tt_tap()</a> function onto our tempo tapper struct instance. Should to keyboard input be none of the previously mentioned characters, then the program will print a <code>Invalid input!</code> message.</p>
<p>Finally, at the end of the loop we print the detected tempo in BPM, using the <a class="el" href="tempo__tapper__common_8cxx.html#aa8e3549026a6efbb514b6b36dd109432" title="Returns the tempo in BPM.">tt_bpm()</a> function, and the period time in milliseconds by diving the period time in microseconds, retrieved by <a class="el" href="tempo__tapper__common_8cxx.html#a64b7b4c29845f07ba8678b35968f66cc" title="Returns the period of a tempo in microseconds.">tt_period_us()</a>, by 1000. Then we print the <code>Press r to reset, press q to quit.</code> message and refresh the terminal window to show all changes using the <a href="https://linux.die.net/man/3/refresh">refresh()</a> function.</p>
<p>If the user has pressed the q key, the inner and outer loops will terminate and we get to the very end of our program where we simply end the ncruses window, free our memory allocated by the tempo tapper struct, and lastly return 0:</p>
<div class="fragment"><div class="line">endwin();</div>
<div class="line">free(tt);</div>
<div class="line"><span class="keywordflow">return</span> 0;</div>
</div><!-- fragment --><h1><a class="anchor" id="CPP-Wrapper"></a>
C++ Wrapper</h1>
<p>The Tempo Tapper library also provides a <a class="el" href="classtempo__tapper__cpp.html">C++ wrapper class</a> to implement a tempo tapper. It can be included with the <a class="el" href="tempo__tapper__cpp_8h.html" title="C++ wrapper for the tempo tapper library.">tempo_tapper_cpp.h</a> header, stores a private tempo tapper struct instance, and provides member methods that simply wrap around the C interface.</p>
<p>Please refer to the <a class="el" href="classtempo__tapper__cpp.html">C++ wrapper class reference</a> and to the <a class="el" href="term__tt__posix__cpp_8cxx.html" title="C++ wrapper implementation of term_tt_posix.cxx.">examples/posix/term_tt_posix_cpp.cxx</a> example, where we implement the terminal based tempo tapper example, disucssed in the <a class="el" href="index.html#Example">example section above</a>, using the C++ wrapper. </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
<div class="ttc" id="atempo__tapper__common_8cxx_html_a08a70fd14b08b0b2c49d5975777b0178"><div class="ttname"><a href="tempo__tapper__common_8cxx.html#a08a70fd14b08b0b2c49d5975777b0178">tt_tap</a></div><div class="ttdeci">void tt_tap(tempo_tapper *tapper)</div><div class="ttdoc">&quot;Taps&quot; the tempo tapper</div><div class="ttdef"><b>Definition:</b> <a href="tempo__tapper__common_8cxx_source.html#l00046">tempo_tapper_common.cxx:46</a></div></div>
<div class="ttc" id="atempo__tapper__common_8cxx_html_af7160cb12c6cc18e6d4322235ba25fc4"><div class="ttname"><a href="tempo__tapper__common_8cxx.html#af7160cb12c6cc18e6d4322235ba25fc4">tt_reset</a></div><div class="ttdeci">void tt_reset(tempo_tapper *tapper)</div><div class="ttdoc">Resets the tempo tapper.</div><div class="ttdef"><b>Definition:</b> <a href="tempo__tapper__common_8cxx_source.html#l00083">tempo_tapper_common.cxx:83</a></div></div>
<div class="ttc" id="atempo__tapper__common_8cxx_html_a651d8d5e4cfd850c4174f8afa381526a"><div class="ttname"><a href="tempo__tapper__common_8cxx.html#a651d8d5e4cfd850c4174f8afa381526a">tt_new</a></div><div class="ttdeci">tempo_tapper * tt_new()</div><div class="ttdoc">Creates a new tempo tapper instance.</div><div class="ttdef"><b>Definition:</b> <a href="tempo__tapper__common_8cxx_source.html#l00061">tempo_tapper_common.cxx:61</a></div></div>
<div class="ttc" id="astructtempo__tapper_html"><div class="ttname"><a href="structtempo__tapper.html">tempo_tapper</a></div><div class="ttdoc">Tempo tapper struct.</div><div class="ttdef"><b>Definition:</b> <a href="tempo__tapper_8h_source.html#l00087">tempo_tapper.h:87</a></div></div>
<div class="ttc" id="atempo__tapper__common_8cxx_html_aa8e3549026a6efbb514b6b36dd109432"><div class="ttname"><a href="tempo__tapper__common_8cxx.html#aa8e3549026a6efbb514b6b36dd109432">tt_bpm</a></div><div class="ttdeci">BPM_t tt_bpm(tempo_tapper *tapper)</div><div class="ttdoc">Returns the tempo in BPM.</div><div class="ttdef"><b>Definition:</b> <a href="tempo__tapper__common_8cxx_source.html#l00072">tempo_tapper_common.cxx:72</a></div></div>
<div class="ttc" id="atempo__tapper__common_8cxx_html_a64b7b4c29845f07ba8678b35968f66cc"><div class="ttname"><a href="tempo__tapper__common_8cxx.html#a64b7b4c29845f07ba8678b35968f66cc">tt_period_us</a></div><div class="ttdeci">unsigned long tt_period_us(tempo_tapper *tapper)</div><div class="ttdoc">Returns the period of a tempo in microseconds.</div><div class="ttdef"><b>Definition:</b> <a href="tempo__tapper__common_8cxx_source.html#l00037">tempo_tapper_common.cxx:37</a></div></div>
<div class="ttc" id="atempo__tapper_8h_html"><div class="ttname"><a href="tempo__tapper_8h.html">tempo_tapper.h</a></div><div class="ttdoc">Provides all necessary structs and functions to implement a tempo tapper.</div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
